import '../models/kpi_model.dart';
import '../../domain/entities/kpi.dart';

abstract class KpiRemoteDataSource {
  Future<List<KpiModel>> getKpis(String userId, KpiPeriod period);
  Future<KpiModel> getKpiById(String kpiId);
  Future<KpiModel> updateKpi(KpiModel kpi);
}

class KpiRemoteDataSourceImpl implements KpiRemoteDataSource {
  @override
  Future<List<KpiModel>> getKpis(String userId, KpiPeriod period) async {
    // Simulate network delay
    await Future.delayed(const Duration(milliseconds: 600));

    // Return all KPI data for all periods in a single request
    // The period parameter is ignored since we load all data at once
    return _getAllKpis();
  }

  @override
  Future<KpiModel> getKpiById(String kpiId) async {
    // Simulate network delay
    await Future.delayed(const Duration(milliseconds: 400));

    // Mock data
    return KpiModel(
      id: kpiId,
      title: 'Производительность разработки',
      description: 'Количество завершенных задач в месяц',
      targetValue: 20,
      currentValue: 18,
      unit: 'задач',
      period: KpiPeriod.monthly,
      startDate: DateTime(2025, 1, 1),
      endDate: DateTime(2025, 12, 31),
      status: KpiStatus.onTrack,
      progressPercentage: 90.0,
      weight: 40.0,
      fact: 40.0,
      kpiCalculation: 80.0,
    );
  }

  @override
  Future<KpiModel> updateKpi(KpiModel kpi) async {
    // Simulate network delay
    await Future.delayed(const Duration(milliseconds: 800));

    // Return updated kpi
    return kpi;
  }

  List<KpiModel> _getAllKpis() {
    return [
      // Q1 2025 KPIs
      KpiModel(
        id: 'q1_1',
        title: 'Совокупная выручка',
        description: 'Общая выручка за 1 квартал',
        targetValue: 1000000,
        currentValue: 750000,
        unit: '₽',
        period: KpiPeriod.quarterly,
        startDate: DateTime(2025, 1, 1),
        endDate: DateTime(2025, 3, 31),
        status: KpiStatus.onTrack,
        progressPercentage: 75.0,
        weight: 40.0,
        fact: 40.0,
        kpiCalculation: 75.0,
      ),
      KpiModel(
        id: 'q1_2',
        title: 'Название цели 1',
        description: 'Первая индивидуальная цель',
        targetValue: 100,
        currentValue: 80,
        unit: '%',
        period: KpiPeriod.quarterly,
        startDate: DateTime(2025, 1, 1),
        endDate: DateTime(2025, 3, 31),
        status: KpiStatus.onTrack,
        progressPercentage: 80.0,
        weight: 40.0,
        fact: 40.0,
        kpiCalculation: 80.0,
      ),
      KpiModel(
        id: 'q1_3',
        title: 'Название цели 2',
        description: 'Вторая индивидуальная цель',
        targetValue: 100,
        currentValue: 80,
        unit: '%',
        period: KpiPeriod.quarterly,
        startDate: DateTime(2025, 1, 1),
        endDate: DateTime(2025, 3, 31),
        status: KpiStatus.onTrack,
        progressPercentage: 80.0,
        weight: 40.0,
        fact: 40.0,
        kpiCalculation: 80.0,
      ),
      KpiModel(
        id: 'q1_4',
        title: 'Название цели 3',
        description: 'Третья индивидуальная цель',
        targetValue: 100,
        currentValue: 80,
        unit: '%',
        period: KpiPeriod.quarterly,
        startDate: DateTime(2025, 1, 1),
        endDate: DateTime(2025, 3, 31),
        status: KpiStatus.onTrack,
        progressPercentage: 80.0,
        weight: 40.0,
        fact: 40.0,
        kpiCalculation: 80.0,
      ),

      // Q2 2025 KPIs
      KpiModel(
        id: 'q2_1',
        title: 'Совокупная выручка',
        description: 'Общая выручка за 2 квартал',
        targetValue: 1200000,
        currentValue: 900000,
        unit: '₽',
        period: KpiPeriod.quarterly,
        startDate: DateTime(2025, 4, 1),
        endDate: DateTime(2025, 6, 30),
        status: KpiStatus.onTrack,
        progressPercentage: 75.0,
        weight: 40.0,
        fact: 40.0,
        kpiCalculation: 75.0,
      ),
      KpiModel(
        id: 'q2_2',
        title: 'Название цели 1',
        description: 'Первая индивидуальная цель',
        targetValue: 100,
        currentValue: 85,
        unit: '%',
        period: KpiPeriod.quarterly,
        startDate: DateTime(2025, 4, 1),
        endDate: DateTime(2025, 6, 30),
        status: KpiStatus.onTrack,
        progressPercentage: 85.0,
        weight: 40.0,
        fact: 40.0,
        kpiCalculation: 85.0,
      ),
      KpiModel(
        id: 'q2_3',
        title: 'Название цели 2',
        description: 'Вторая индивидуальная цель',
        targetValue: 100,
        currentValue: 90,
        unit: '%',
        period: KpiPeriod.quarterly,
        startDate: DateTime(2025, 4, 1),
        endDate: DateTime(2025, 6, 30),
        status: KpiStatus.onTrack,
        progressPercentage: 90.0,
        weight: 40.0,
        fact: 40.0,
        kpiCalculation: 90.0,
      ),
      KpiModel(
        id: 'q2_4',
        title: 'Название цели 3',
        description: 'Третья индивидуальная цель',
        targetValue: 100,
        currentValue: 75,
        unit: '%',
        period: KpiPeriod.quarterly,
        startDate: DateTime(2025, 4, 1),
        endDate: DateTime(2025, 6, 30),
        status: KpiStatus.onTrack,
        progressPercentage: 75.0,
        weight: 40.0,
        fact: 40.0,
        kpiCalculation: 75.0,
      ),

      // Q3 2025 KPIs
      KpiModel(
        id: 'q3_1',
        title: 'Совокупная выручка',
        description: 'Общая выручка за 3 квартал',
        targetValue: 1100000,
        currentValue: 880000,
        unit: '₽',
        period: KpiPeriod.quarterly,
        startDate: DateTime(2025, 7, 1),
        endDate: DateTime(2025, 9, 30),
        status: KpiStatus.onTrack,
        progressPercentage: 80.0,
        weight: 40.0,
        fact: 40.0,
        kpiCalculation: 80.0,
      ),
      KpiModel(
        id: 'q3_2',
        title: 'Название цели 1',
        description: 'Первая индивидуальная цель',
        targetValue: 100,
        currentValue: 95,
        unit: '%',
        period: KpiPeriod.quarterly,
        startDate: DateTime(2025, 7, 1),
        endDate: DateTime(2025, 9, 30),
        status: KpiStatus.onTrack,
        progressPercentage: 95.0,
        weight: 40.0,
        fact: 40.0,
        kpiCalculation: 95.0,
      ),
      KpiModel(
        id: 'q3_3',
        title: 'Название цели 2',
        description: 'Вторая индивидуальная цель',
        targetValue: 100,
        currentValue: 88,
        unit: '%',
        period: KpiPeriod.quarterly,
        startDate: DateTime(2025, 7, 1),
        endDate: DateTime(2025, 9, 30),
        status: KpiStatus.onTrack,
        progressPercentage: 88.0,
        weight: 40.0,
        fact: 40.0,
        kpiCalculation: 88.0,
      ),
      KpiModel(
        id: 'q3_4',
        title: 'Название цели 3',
        description: 'Третья индивидуальная цель',
        targetValue: 100,
        currentValue: 82,
        unit: '%',
        period: KpiPeriod.quarterly,
        startDate: DateTime(2025, 7, 1),
        endDate: DateTime(2025, 9, 30),
        status: KpiStatus.onTrack,
        progressPercentage: 82.0,
        weight: 40.0,
        fact: 40.0,
        kpiCalculation: 82.0,
      ),

      // Q4 2025 KPIs
      KpiModel(
        id: 'q4_1',
        title: 'Совокупная выручка',
        description: 'Общая выручка за 4 квартал',
        targetValue: 1300000,
        currentValue: 1040000,
        unit: '₽',
        period: KpiPeriod.quarterly,
        startDate: DateTime(2025, 10, 1),
        endDate: DateTime(2025, 12, 31),
        status: KpiStatus.onTrack,
        progressPercentage: 80.0,
        weight: 40.0,
        fact: 40.0,
        kpiCalculation: 80.0,
      ),
      KpiModel(
        id: 'q4_2',
        title: 'Название цели 1',
        description: 'Первая индивидуальная цель',
        targetValue: 100,
        currentValue: 92,
        unit: '%',
        period: KpiPeriod.quarterly,
        startDate: DateTime(2025, 10, 1),
        endDate: DateTime(2025, 12, 31),
        status: KpiStatus.onTrack,
        progressPercentage: 92.0,
        weight: 40.0,
        fact: 40.0,
        kpiCalculation: 92.0,
      ),
      KpiModel(
        id: 'q4_3',
        title: 'Название цели 2',
        description: 'Вторая индивидуальная цель',
        targetValue: 100,
        currentValue: 87,
        unit: '%',
        period: KpiPeriod.quarterly,
        startDate: DateTime(2025, 10, 1),
        endDate: DateTime(2025, 12, 31),
        status: KpiStatus.onTrack,
        progressPercentage: 87.0,
        weight: 40.0,
        fact: 40.0,
        kpiCalculation: 87.0,
      ),
      KpiModel(
        id: 'q4_4',
        title: 'Название цели 3',
        description: 'Третья индивидуальная цель',
        targetValue: 100,
        currentValue: 78,
        unit: '%',
        period: KpiPeriod.quarterly,
        startDate: DateTime(2025, 10, 1),
        endDate: DateTime(2025, 12, 31),
        status: KpiStatus.onTrack,
        progressPercentage: 78.0,
        weight: 40.0,
        fact: 40.0,
        kpiCalculation: 78.0,
      ),

      // H1 2025 KPIs (Jan-Jun)
      KpiModel(
        id: 'h1_1',
        title: 'Совокупная выручка',
        description: 'Общая выручка за 1 полугодие',
        targetValue: 2200000,
        currentValue: 1650000,
        unit: '₽',
        period: KpiPeriod.halfYear,
        startDate: DateTime(2025, 1, 1),
        endDate: DateTime(2025, 6, 30),
        status: KpiStatus.onTrack,
        progressPercentage: 75.0,
        weight: 40.0,
        fact: 40.0,
        kpiCalculation: 75.0,
      ),
      KpiModel(
        id: 'h1_2',
        title: 'Название цели 1',
        description: 'Первая индивидуальная цель',
        targetValue: 100,
        currentValue: 82,
        unit: '%',
        period: KpiPeriod.halfYear,
        startDate: DateTime(2025, 1, 1),
        endDate: DateTime(2025, 6, 30),
        status: KpiStatus.onTrack,
        progressPercentage: 82.0,
        weight: 40.0,
        fact: 40.0,
        kpiCalculation: 82.0,
      ),
      KpiModel(
        id: 'h1_3',
        title: 'Название цели 2',
        description: 'Вторая индивидуальная цель',
        targetValue: 100,
        currentValue: 85,
        unit: '%',
        period: KpiPeriod.halfYear,
        startDate: DateTime(2025, 1, 1),
        endDate: DateTime(2025, 6, 30),
        status: KpiStatus.onTrack,
        progressPercentage: 85.0,
        weight: 40.0,
        fact: 40.0,
        kpiCalculation: 85.0,
      ),
      KpiModel(
        id: 'h1_4',
        title: 'Название цели 3',
        description: 'Третья индивидуальная цель',
        targetValue: 100,
        currentValue: 77,
        unit: '%',
        period: KpiPeriod.halfYear,
        startDate: DateTime(2025, 1, 1),
        endDate: DateTime(2025, 6, 30),
        status: KpiStatus.onTrack,
        progressPercentage: 77.0,
        weight: 40.0,
        fact: 40.0,
        kpiCalculation: 77.0,
      ),

      // H2 2025 KPIs (Jul-Dec)
      KpiModel(
        id: 'h2_1',
        title: 'Совокупная выручка',
        description: 'Общая выручка за 2 полугодие',
        targetValue: 2400000,
        currentValue: 1920000,
        unit: '₽',
        period: KpiPeriod.halfYear,
        startDate: DateTime(2025, 7, 1),
        endDate: DateTime(2025, 12, 31),
        status: KpiStatus.onTrack,
        progressPercentage: 80.0,
        weight: 40.0,
        fact: 40.0,
        kpiCalculation: 80.0,
      ),
      KpiModel(
        id: 'h2_2',
        title: 'Название цели 1',
        description: 'Первая индивидуальная цель',
        targetValue: 100,
        currentValue: 93,
        unit: '%',
        period: KpiPeriod.halfYear,
        startDate: DateTime(2025, 7, 1),
        endDate: DateTime(2025, 12, 31),
        status: KpiStatus.onTrack,
        progressPercentage: 93.0,
        weight: 40.0,
        fact: 40.0,
        kpiCalculation: 93.0,
      ),
      KpiModel(
        id: 'h2_3',
        title: 'Название цели 2',
        description: 'Вторая индивидуальная цель',
        targetValue: 100,
        currentValue: 87,
        unit: '%',
        period: KpiPeriod.halfYear,
        startDate: DateTime(2025, 7, 1),
        endDate: DateTime(2025, 12, 31),
        status: KpiStatus.onTrack,
        progressPercentage: 87.0,
        weight: 40.0,
        fact: 40.0,
        kpiCalculation: 87.0,
      ),
      KpiModel(
        id: 'h2_4',
        title: 'Название цели 3',
        description: 'Третья индивидуальная цель',
        targetValue: 100,
        currentValue: 80,
        unit: '%',
        period: KpiPeriod.halfYear,
        startDate: DateTime(2025, 7, 1),
        endDate: DateTime(2025, 12, 31),
        status: KpiStatus.onTrack,
        progressPercentage: 80.0,
        weight: 40.0,
        fact: 40.0,
        kpiCalculation: 80.0,
      ),

      // 2024 Year KPIs
      KpiModel(
        id: 'y2024_1',
        title: 'Совокупная выручка',
        description: 'Общая выручка за 2024 год',
        targetValue: 4000000,
        currentValue: 2760000,
        unit: '₽',
        period: KpiPeriod.yearly,
        startDate: DateTime(2024, 1, 1),
        endDate: DateTime(2024, 12, 31),
        status: KpiStatus.onTrack,
        progressPercentage: 69.0,
        weight: 40.0,
        fact: 40.0,
        kpiCalculation: 75.0,
      ),
      KpiModel(
        id: 'y2024_2',
        title: 'Название цели 1',
        description: 'Первая индивидуальная цель',
        targetValue: 100,
        currentValue: 80,
        unit: '%',
        period: KpiPeriod.yearly,
        startDate: DateTime(2024, 1, 1),
        endDate: DateTime(2024, 12, 31),
        status: KpiStatus.onTrack,
        progressPercentage: 80.0,
        weight: 40.0,
        fact: 40.0,
        kpiCalculation: 80.0,
      ),
      KpiModel(
        id: 'y2024_3',
        title: 'Название цели 2',
        description: 'Вторая индивидуальная цель',
        targetValue: 100,
        currentValue: 80,
        unit: '%',
        period: KpiPeriod.yearly,
        startDate: DateTime(2024, 1, 1),
        endDate: DateTime(2024, 12, 31),
        status: KpiStatus.onTrack,
        progressPercentage: 80.0,
        weight: 40.0,
        fact: 40.0,
        kpiCalculation: 80.0,
      ),
      KpiModel(
        id: 'y2024_4',
        title: 'Название цели 3',
        description: 'Третья индивидуальная цель',
        targetValue: 100,
        currentValue: 80,
        unit: '%',
        period: KpiPeriod.yearly,
        startDate: DateTime(2024, 1, 1),
        endDate: DateTime(2024, 12, 31),
        status: KpiStatus.onTrack,
        progressPercentage: 80.0,
        weight: 40.0,
        fact: 40.0,
        kpiCalculation: 80.0,
      ),

      // 2025 Year KPIs
      KpiModel(
        id: 'y2025_1',
        title: 'Совокупная выручка',
        description: 'Общая выручка за 2025 год',
        targetValue: 4600000,
        currentValue: 3570000,
        unit: '₽',
        period: KpiPeriod.yearly,
        startDate: DateTime(2025, 1, 1),
        endDate: DateTime(2025, 12, 31),
        status: KpiStatus.onTrack,
        progressPercentage: 77.6,
        weight: 40.0,
        fact: 40.0,
        kpiCalculation: 77.6,
      ),
      KpiModel(
        id: 'y2025_2',
        title: 'Название цели 1',
        description: 'Первая индивидуальная цель',
        targetValue: 100,
        currentValue: 88,
        unit: '%',
        period: KpiPeriod.yearly,
        startDate: DateTime(2025, 1, 1),
        endDate: DateTime(2025, 12, 31),
        status: KpiStatus.onTrack,
        progressPercentage: 88.0,
        weight: 40.0,
        fact: 40.0,
        kpiCalculation: 88.0,
      ),
      KpiModel(
        id: 'y2025_3',
        title: 'Название цели 2',
        description: 'Вторая индивидуальная цель',
        targetValue: 100,
        currentValue: 85,
        unit: '%',
        period: KpiPeriod.yearly,
        startDate: DateTime(2025, 1, 1),
        endDate: DateTime(2025, 12, 31),
        status: KpiStatus.onTrack,
        progressPercentage: 85.0,
        weight: 40.0,
        fact: 40.0,
        kpiCalculation: 85.0,
      ),
      KpiModel(
        id: 'y2025_4',
        title: 'Название цели 3',
        description: 'Третья индивидуальная цель',
        targetValue: 100,
        currentValue: 79,
        unit: '%',
        period: KpiPeriod.yearly,
        startDate: DateTime(2025, 1, 1),
        endDate: DateTime(2025, 12, 31),
        status: KpiStatus.onTrack,
        progressPercentage: 79.0,
        weight: 40.0,
        fact: 40.0,
        kpiCalculation: 79.0,
      ),
    ];
  }
}
